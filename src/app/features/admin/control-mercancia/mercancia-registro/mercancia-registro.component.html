<div *ngIf="cargando" class="cargando">
  <mat-spinner></mat-spinner>
</div>

<div class="mercancia-container">

  <!-- üîç Barra de b√∫squeda -->
  <div class="buscador">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Buscar producto</mat-label>
      <input
        matInput
        placeholder="Escribe para filtrar..."
        (keyup)="aplicarFiltro($event)"
      />
      <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>
  </div>

  <!-- üìã Tabla con datos -->
  <table
    mat-table
    [dataSource]="dataSource"
    matSort
    class="mat-elevation-z8 full-width-table"
  >
    <!-- Producto -->
    <ng-container matColumnDef="producto">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Producto </th>
      <td mat-cell *matCellDef="let item"> {{ item.producto }} </td>
    </ng-container>

    <ng-container matColumnDef="categoria">
  <th mat-header-cell *matHeaderCellDef>Categor√≠a</th>
  <td mat-cell *matCellDef="let item">{{ item.categoria }}</td>
</ng-container>

<ng-container matColumnDef="proveedor">
  <th mat-header-cell *matHeaderCellDef>Proveedor</th>
  <td mat-cell *matCellDef="let item">{{ item.proveedor }}</td>
</ng-container>


    <!-- Cantidad Bodega -->
    <ng-container matColumnDef="cantidadBodega">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Bodega </th>
      <td mat-cell *matCellDef="let item"> {{ item.cantidadBodega }} </td>
    </ng-container>

    <!-- Cantidad Stock -->
    <ng-container matColumnDef="cantidadStock">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Stock </th>
      <td mat-cell *matCellDef="let item"> {{ item.cantidadStock }} </td>
    </ng-container>

    <!-- Cantidad a Mover -->
    <ng-container matColumnDef="cantidadMover">
      <th mat-header-cell *matHeaderCellDef> Mover </th>
      <td mat-cell *matCellDef="let item">
        <form [formGroup]="formularios[item.id]">
          <mat-form-field appearance="outline" class="cantidad-input">
            <input
              matInput
              type="number"
              formControlName="cantidadMover"
              min="1"
            />
          </mat-form-field>
        </form>
      </td>
    </ng-container>

    <!-- Acciones -->
    <ng-container matColumnDef="acciones">
      <th mat-header-cell *matHeaderCellDef> Acciones </th>
      <td mat-cell *matCellDef="let item">
        <button
          mat-raised-button
          color="primary"
          (click)="moverAStock(item)"
        >
          A Stock
        </button>
        <button
          mat-raised-button
          color="accent"
          (click)="moverABodega(item)"
        >
          A Bodega
        </button>
      </td>
    </ng-container>

    <!-- Encabezados y filas -->
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr
      mat-row
      *matRowDef="let row; columns: displayedColumns"
    ></tr>
  </table>

  <!-- üìÑ Paginador -->
  <mat-paginator
    [pageSizeOptions]="[5, 10, 20]"
    showFirstLastButtons
  ></mat-paginator>

  <div *ngIf="cargando" class="loading-text">
    Cargando mercanc√≠a...
  </div>
</div>
