<div class="order-management-container">
  <h2>
    <mat-icon>shopping_cart</mat-icon>
    {{ tipoVista === 'cliente' ? 'Pedidos de Clientes' : 'Pedidos de Vendedores' }}
  </h2>

  <!-- üîç Campo de b√∫squeda -->
  <div class="buscador">
    <mat-form-field appearance="outline" class="w-100">
      <mat-label>Buscar por nombre o correo</mat-label>
      <input
        matInput
        [(ngModel)]="filtroActual"
        (ngModelChange)="actualizarFiltro()"
        placeholder="Buscar..."
      />
      <button
        *ngIf="filtroActual"
        matSuffix
        mat-icon-button
        (click)="limpiarFiltro()"
      >
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
  </div>

  <!-- üßæ Tabla Clientes -->
  <div *ngIf="tipoVista === 'cliente'" class="tabla-wrapper animate-fade">
    <table mat-table [dataSource]="clientesFiltrados()" class="mat-elevation-z2 tabla-pedidos">
      <ng-container matColumnDef="nombre">
        <th mat-header-cell *matHeaderCellDef>Nombre</th>
        <td mat-cell *matCellDef="let c">{{ c.nombre }}</td>
      </ng-container>

      <ng-container matColumnDef="correo">
        <th mat-header-cell *matHeaderCellDef>Correo</th>
        <td mat-cell *matCellDef="let c">{{ c.correo }}</td>
      </ng-container>

      <ng-container matColumnDef="ciudad">
        <th mat-header-cell *matHeaderCellDef>Ciudad</th>
        <td mat-cell *matCellDef="let c">{{ c.ciudad || '-' }}</td>
      </ng-container>

      <ng-container matColumnDef="telefono">
        <th mat-header-cell *matHeaderCellDef>Tel√©fono</th>
        <td mat-cell *matCellDef="let c">{{ c.telefono || '-' }}</td>
      </ng-container>

      <ng-container matColumnDef="cantidadPedidos">
        <th mat-header-cell *matHeaderCellDef>Pedidos</th>
        <td mat-cell *matCellDef="let c">{{ c.cantidadPedidos || 0 }}</td>
      </ng-container>

      <ng-container matColumnDef="totalComprado">
        <th mat-header-cell *matHeaderCellDef>Total Comprado</th>
        <td mat-cell *matCellDef="let c">{{ c.totalComprado | currency: 'COP' }}</td>
      </ng-container>

      <ng-container matColumnDef="acciones">
        <th mat-header-cell *matHeaderCellDef>Acciones</th>
        <td mat-cell *matCellDef="let c">
          <button mat-icon-button color="primary" (click)="abrirPedidos(c)">
            <mat-icon>visibility</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumnsCliente"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumnsCliente"></tr>
    </table>
  </div>

  <!-- üè¨ Tabla Vendedores -->
  <div *ngIf="tipoVista === 'vendedor'" class="tabla-wrapper animate-fade">
    <table mat-table [dataSource]="vendedoresFiltrados()" class="mat-elevation-z2 tabla-pedidos">
      <ng-container matColumnDef="nombre">
        <th mat-header-cell *matHeaderCellDef>Nombre</th>
        <td mat-cell *matCellDef="let v">{{ v.nombre }}</td>
      </ng-container>

      <ng-container matColumnDef="correo">
        <th mat-header-cell *matHeaderCellDef>Correo</th>
        <td mat-cell *matCellDef="let v">{{ v.correo }}</td>
      </ng-container>

      <ng-container matColumnDef="telefono">
        <th mat-header-cell *matHeaderCellDef>Tel√©fono</th>
        <td mat-cell *matCellDef="let v">{{ v.telefono || '-' }}</td>
      </ng-container>

      <ng-container matColumnDef="cantidadPedidos">
        <th mat-header-cell *matHeaderCellDef>Pedidos</th>
        <td mat-cell *matCellDef="let v">{{ v.cantidadPedidos || 0 }}</td>
      </ng-container>

      <ng-container matColumnDef="totalVendido">
        <th mat-header-cell *matHeaderCellDef>Total Vendido</th>
        <td mat-cell *matCellDef="let v">{{ v.totalVendido | currency: 'COP' }}</td>
      </ng-container>

      <ng-container matColumnDef="acciones">
        <th mat-header-cell *matHeaderCellDef>Acciones</th>
        <td mat-cell *matCellDef="let v">
          <button mat-icon-button color="primary" (click)="abrirPedidos(v)">
            <mat-icon>visibility</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumnsVendedor"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumnsVendedor"></tr>
    </table>
  </div>
</div>
